<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>新码农</title>
  
  <subtitle>新码农博客</subtitle>
  <link href="https://addcoder.com/atom.xml" rel="self"/>
  
  <link href="https://addcoder.com/"/>
  <updated>2024-10-27T16:00:00.000Z</updated>
  <id>https://addcoder.com/</id>
  
  <author>
    <name>Gilmty</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>No126：NAS群晖DS218+使用笔记</title>
    <link href="https://addcoder.com/posts/7bc3db82"/>
    <id>https://addcoder.com/posts/7bc3db82</id>
    <published>2024-05-31T16:00:00.000Z</published>
    <updated>2024-10-27T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="系统"><a href="#系统" class="headerlink" title="系统"></a>系统</h3><ol><li><a href="https://finds.synology.com/">查找群晖设备</a>，或者使用Synology Asistant</li><li>安装最新版本（DSM 7.2.1-69057 Update 5），可以从<a href="https://www.synology.cn/zh-cn/support/download/DS218+">群晖官网</a>下载好pat文件</li><li>磁盘阵列选择（RAID 1），文件系统选择（Btrfs）</li><li>新建存储池（相当于硬盘），存储空间（相当于硬盘下分区），共享文件夹（相当于分区下文件夹）</li><li>申请<a href="https://www.synology.cn/">群晖账号</a>，设置QuickConect<br><img src="/posts/7bc3db82/%E8%AE%BE%E7%BD%AEQuickConect.jpg" alt="设置QuickConect" title="设置QuickConect"></li><li>固定局域网IP<br><img src="/posts/7bc3db82/%E5%9B%BA%E5%AE%9A%E5%B1%80%E5%9F%9F%E7%BD%91IP.jpg" alt="固定局域网IP" title="固定局域网IP"></li><li>开启SSH<br><img src="/posts/7bc3db82/%E5%BC%80%E5%90%AFSSH.jpg" alt="开启SSH" title="开启SSH"></li><li>开启SFTP<br><img src="/posts/7bc3db82/%E5%BC%80%E5%90%AFSFTP.jpg" alt="开启SFTP" title="开启SFTP"></li><li>关闭强转HTTPS<br><img src="/posts/7bc3db82/%E5%85%B3%E9%97%AD%E5%BC%BA%E8%BD%ACHTTPS.jpg" alt="关闭强转HTTPS" title="关闭强转HTTPS"></li><li>关闭自动更新<br><img src="/posts/7bc3db82/%E5%85%B3%E9%97%AD%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0.jpg" alt="关闭自动更新" title="关闭自动更新"></li></ol><h3 id="套件"><a href="#套件" class="headerlink" title="套件"></a>套件</h3><h4 id="添加套件源"><a href="#添加套件源" class="headerlink" title="添加套件源"></a>添加套件源</h4><p><img src="/posts/7bc3db82/%E5%A5%97%E4%BB%B6%E6%BA%90.jpg" alt="套件源" title="套件源"></p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">synocommunity</span></span><br><span class="line">https://packages.synocommunity.com</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">cphub</span></span><br><span class="line">https://www.cphub.net</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">sysco</span></span><br><span class="line">https://synology.sysco.ch</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">4sa</span></span><br><span class="line">https://spk.4sag.ru</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">云梦</span></span><br><span class="line">https://spk.520810.xyz:666</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">我不是矿神</span></span><br><span class="line">https://spk7.imnks.com</span><br></pre></td></tr></table></figure><h4 id="删除系统内部用户账号"><a href="#删除系统内部用户账号" class="headerlink" title="删除系统内部用户账号"></a>删除系统内部用户账号</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取root权限</span></span><br><span class="line">sudo -i</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">编辑系统用户文件</span></span><br><span class="line">vim /etc/passwd</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">根据需要更改文件，保存后重启系统</span></span><br></pre></td></tr></table></figure><h4 id="删除套件卸载后遗留文件"><a href="#删除套件卸载后遗留文件" class="headerlink" title="删除套件卸载后遗留文件"></a>删除套件卸载后遗留文件</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取root权限</span></span><br><span class="line">sudo -i</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">卸载套件后会有遗留文件，保存在以下文件夹</span></span><br><span class="line">cd /volume1/@appconf</span><br><span class="line">cd /volume1/@appdata</span><br><span class="line">cd /volume1/@apphome</span><br><span class="line">cd /volume1/@appstore</span><br><span class="line">cd /volume1/@apptemp</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">根据需要删除文件夹</span></span><br><span class="line">rm -rf xxx</span><br></pre></td></tr></table></figure><h3 id="科学上网"><a href="#科学上网" class="headerlink" title="科学上网"></a>科学上网</h3><h4 id="V2Ray"><a href="#V2Ray" class="headerlink" title="V2Ray"></a>V2Ray</h4><ol><li>Docker注册表搜索下载镜像（mzz2017&#x2F;v2raya:latest）</li><li>映射端口：2017&#x3D;2017，20170&#x3D;20170，20171&#x3D;20171</li><li>映射文件：无</li><li>映射文件夹：&#x2F;docker&#x2F;v2raya&#x3D;&#x2F;etc&#x2F;v2raya</li><li>环境变量：TZ&#x3D;Asia&#x2F;Shanghai，V2RAYA_LOG_FILE&#x3D;&#x2F;tmp&#x2F;v2raya.log</li><li>网络：bridge</li></ol><h4 id="Clash"><a href="#Clash" class="headerlink" title="Clash"></a>Clash</h4><ul><li>准备Clash配置文件，订阅信息自行获取</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">基础信息</span></span><br><span class="line">mixed-port: 7890</span><br><span class="line">socks-port: 7898</span><br><span class="line">port: 7899</span><br><span class="line">log-level: info</span><br><span class="line">allow-lan: true</span><br><span class="line">mode: rule</span><br><span class="line">external-controller: 0.0.0.0:9090</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">订阅信息</span></span><br><span class="line">......</span><br></pre></td></tr></table></figure><ol><li>Docker注册表搜索下载镜像（dreamacro&#x2F;clash:latest）</li><li>映射端口：7890&#x3D;7890，9090&#x3D;9090</li><li>映射文件：&#x2F;docker&#x2F;clash&#x2F;config.yaml&#x3D;&#x2F;root&#x2F;.config&#x2F;clash&#x2F;config.yaml</li><li>映射文件夹：无</li><li>环境变量：TZ&#x3D;Asia&#x2F;Shanghai</li><li>权限：高</li><li>网络：bridge</li><li>命令：无</li></ol><ul><li><a href="http://yacd.haishan.me/">在线UI界面</a></li></ul><ol><li>Docker注册表搜索下载镜像（haishanh&#x2F;yacd:latest）</li><li>映射端口：9099&#x3D;80</li><li>映射文件：无</li><li>映射文件夹：无</li><li>环境变量：TZ&#x3D;Asia&#x2F;Shanghai</li><li>权限：高</li><li>网络：bridge</li><li>命令：无</li></ol><ul><li>访问<a href="http://nas_ip:9099/">http://NAS_IP:9099</a></li></ul><h3 id="组网穿透"><a href="#组网穿透" class="headerlink" title="组网穿透"></a>组网穿透</h3><h4 id="节点小宝"><a href="#节点小宝" class="headerlink" title="节点小宝"></a>节点小宝</h4><ol><li>Docker注册表搜索下载镜像（ionewu&#x2F;owjdxb:latest）</li><li>映射端口：无</li><li>映射文件：无</li><li>映射文件夹：&#x2F;docker&#x2F;owjdxb&#x2F;store&#x3D;&#x2F;data&#x2F;store</li><li>环境变量：无</li><li>权限：高</li><li>网络：host</li><li>命令：无</li></ol><h4 id="星空组网"><a href="#星空组网" class="headerlink" title="星空组网"></a>星空组网</h4><ol><li><a href="https://doc.starvpn.cn/#/docker">官网</a>下载镜像</li><li>映射端口：无</li><li>映射文件：无</li><li>映射文件夹：无</li><li>环境变量：STARS_USER&#x3D;成员账号，STARS_PASS&#x3D;成员密码</li><li>权限：高</li><li>网络：host</li><li>命令：无</li></ol><h4 id="DDNSTO"><a href="#DDNSTO" class="headerlink" title="DDNSTO"></a>DDNSTO</h4><ol><li>Docker注册表搜索下载镜像（linkease&#x2F;ddnsto:latest）</li><li>映射端口：无</li><li>映射文件：无</li><li>映射文件夹：&#x2F;docker&#x2F;ddnsto&#x2F;config&#x3D;&#x2F;ddnsto-config</li><li>环境变量：PUID&#x3D;0，PGID&#x3D;0，TOKEN&#x3D;官网TOKEN</li><li>权限：高</li><li>网络：host</li><li>命令：无</li></ol><h4 id="ZeroNews"><a href="#ZeroNews" class="headerlink" title="ZeroNews"></a>ZeroNews</h4><ol><li>Docker注册表搜索下载镜像（zeronews&#x2F;zeronews:latest）</li><li>映射端口：无</li><li>映射文件：无</li><li>映射文件夹：&#x2F;docker&#x2F;zeronews&#x3D;&#x2F;etc&#x2F;zeronews</li><li>环境变量：TZ&#x3D;Asia&#x2F;Shanghai，TOKEN&#x3D;官网TOKEN</li><li>权限：高</li><li>网络：host</li><li>命令：无</li></ol><h3 id="Bitwarden"><a href="#Bitwarden" class="headerlink" title="Bitwarden"></a>Bitwarden</h3><ol><li>Docker注册表搜索下载镜像（vaultwarden&#x2F;server:latest）</li><li>映射端口：30123&#x3D;80</li><li>映射文件：无</li><li>映射文件夹：&#x2F;docker&#x2F;bitwarden&#x2F;data&#x3D;&#x2F;data</li><li>环境变量：TZ&#x3D;Asia&#x2F;Shanghai，ADMIN_TOKEN&#x3D;管理员代码</li><li>权限：高</li><li>网络：bridge</li><li>命令：无</li></ol><h3 id="aliyundrive-webdav"><a href="#aliyundrive-webdav" class="headerlink" title="aliyundrive-webdav"></a>aliyundrive-webdav</h3><ol><li>Docker注册表搜索下载镜像（messense&#x2F;aliyundrive-webdav:latest）</li><li>映射端口：18080&#x3D;8080</li><li>映射文件：无</li><li>映射文件夹：无</li><li>环境变量：REFRESH_TOKEN&#x3D;token，WEBDAV_AUTH_USER&#x3D;admin，WEBDAV_AUTH_PASSWORD&#x3D;admin</li><li>权限：高</li><li>网络：bridge</li><li>命令：无</li></ol><ul><li>aliyundrive-webdav <a href="https://github.com/messense/aliyundrive-webdav">aliyundrive-webdav refresh token 获取</a>：<a href="https://messense-aliyundrive-webdav-backendrefresh-token-ucs0wn.streamlit.app/">https://messense-aliyundrive-webdav-backendrefresh-token-ucs0wn.streamlit.app</a></li></ul><h3 id="Memos"><a href="#Memos" class="headerlink" title="Memos"></a>Memos</h3><ol><li>Docker注册表搜索下载镜像（neosmemo&#x2F;memos:latest）</li><li>映射端口：5230&#x3D;5230</li><li>映射文件：无</li><li>映射文件夹：&#x2F;docker&#x2F;memos&#x3D;&#x2F;var&#x2F;opt&#x2F;memos</li><li>环境变量：TZ&#x3D;Asia&#x2F;Shanghai</li><li>权限：高</li><li>网络：bridge</li><li>命令：无</li></ol><h3 id="Jellyfin"><a href="#Jellyfin" class="headerlink" title="Jellyfin"></a>Jellyfin</h3><ol><li>Docker注册表搜索下载镜像（jellyfin&#x2F;jellyfin:10.9.7）</li><li>映射端口：无</li><li>映射文件：无</li><li>映射文件夹：&#x2F;docker&#x2F;jellyfin&#x2F;config&#x3D;&#x2F;config，&#x2F;docker&#x2F;jellyfin&#x2F;cache&#x3D;&#x2F;cache，&#x2F;video&#x3D;&#x2F;video</li><li>环境变量：TZ&#x3D;Asia&#x2F;Shanghai</li><li>权限：高</li><li>网络：host</li><li>命令：无</li></ol><ul><li><p>MetaShark <a href="https://github.com/cxfksword/jellyfin-plugin-metashark">刮削豆瓣插件</a>：<a href="https://mirror.ghproxy.com/https://github.com/cxfksword/jellyfin-plugin-metashark/releases/download/manifest/manifest_cn.json">https://mirror.ghproxy.com/https://github.com/cxfksword/jellyfin-plugin-metashark/releases/download/manifest/manifest_cn.json</a></p></li><li><p>MetaTube <a href="https://github.com/metatube-community/jellyfin-plugin-metatube">小姐姐插件</a>：<a href="https://cdn.jsdelivr.net/gh/metatube-community/jellyfin-plugin-metatube@dist/manifest.json">https://cdn.jsdelivr.net/gh/metatube-community/jellyfin-plugin-metatube@dist/manifest.json</a></p></li><li><p>媒体封面显示方块的解决方法</p></li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取root权限</span></span><br><span class="line">sudo -i</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">通过终端进入容器</span></span><br><span class="line">docker exec -it jellyfin /bin/bash</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">更新软件包</span></span><br><span class="line">apt update</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安装字体</span></span><br><span class="line">apt install -y fonts-noto-cjk-extra</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">重启容器</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">删除方块封面</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">扫描媒体库</span></span><br></pre></td></tr></table></figure><ul><li><p>字幕显示方块的解决方法</p><ol><li>下载喜欢的字体文件，ttf格式，Windows系统可从（C:\Windows\Fonts）复制</li><li>上传至群晖指定文件夹</li><li>Jellyfin启用备用字体<br><img src="/posts/7bc3db82/Jellyfin%E5%90%AF%E7%94%A8%E5%A4%87%E7%94%A8%E5%AD%97%E4%BD%93.jpg" alt="Jellyfin启用备用字体" title="Jellyfin启用备用字体"></li><li>重启群晖</li></ol></li><li><p>刮削失败的解决方法</p></li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取root权限</span></span><br><span class="line">sudo -i</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">编辑hosts文件</span></span><br><span class="line">vim /etc/hosts</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">添加以下内容</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">www.themoviedb.org</span></span><br><span class="line">54.192.151.79 www.themoviedb.org</span><br><span class="line">108.139.59.8 www.themoviedb.org</span><br><span class="line">108.139.59.26 www.themoviedb.org</span><br><span class="line">108.139.59.81 www.themoviedb.org</span><br><span class="line">108.139.59.109 www.themoviedb.org</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">api.tmdb.org</span></span><br><span class="line">18.66.102.20 api.tmdb.org</span><br><span class="line">18.66.102.56 api.tmdb.org</span><br><span class="line">18.66.102.75 api.tmdb.org</span><br><span class="line">18.66.102.107 api.tmdb.org</span><br><span class="line">52.222.144.21 api.tmdb.org</span><br><span class="line">52.222.144.63 api.tmdb.org</span><br><span class="line">52.222.144.96 api.tmdb.org</span><br><span class="line">52.222.144.120 api.tmdb.org</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">api.thetvdb.com</span></span><br><span class="line">3.160.72.100 api.thetvdb.com</span><br><span class="line">13.35.161.120 api.thetvdb.com</span><br><span class="line">13.225.89.239 api.thetvdb.com</span><br><span class="line">13.249.175.212 api.thetvdb.com</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">image.tmdb.org</span></span><br><span class="line">143.244.50.88 image.tmdb.org</span><br><span class="line">143.244.50.89 image.tmdb.org</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">api.themoviedb.org</span></span><br><span class="line">13.35.7.102 api.themoviedb.org</span><br><span class="line">13.35.67.86 api.themoviedb.org</span><br><span class="line">13.35.169.17 api.themoviedb.org</span><br><span class="line">13.35.169.94 api.themoviedb.org</span><br><span class="line">13.35.169.119 api.themoviedb.org</span><br><span class="line">13.35.169.128 api.themoviedb.org</span><br><span class="line">13.224.161.90 api.themoviedb.org</span><br><span class="line">13.225.41.40 api.themoviedb.org</span><br><span class="line">13.225.103.26 api.themoviedb.org</span><br><span class="line">13.225.103.110 api.themoviedb.org</span><br><span class="line">13.226.191.85 api.themoviedb.org</span><br><span class="line">13.226.238.76 api.themoviedb.org</span><br><span class="line">13.226.251.88 api.themoviedb.org</span><br><span class="line">52.85.79.89 api.themoviedb.org</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">github.com</span></span><br><span class="line">140.82.114.4 github.com</span><br><span class="line">20.205.243.166 github.com</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">raw.github.com</span></span><br><span class="line">185.199.108.133 raw.github.com</span><br><span class="line">185.199.109.133 raw.github.com</span><br><span class="line">185.199.110.133 raw.github.com</span><br><span class="line">185.199.111.133 raw.github.com</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">raw.githubusercontent.com</span></span><br><span class="line">185.199.108.133 raw.githubusercontent.com</span><br><span class="line">185.199.109.133 raw.githubusercontent.com</span><br><span class="line">185.199.110.133 raw.githubusercontent.com</span><br><span class="line">185.199.111.133 raw.githubusercontent.com</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="迅雷"><a href="#迅雷" class="headerlink" title="迅雷"></a>迅雷</h3><ol><li>套件中心搜索安装</li><li>内测邀请码：W67WUQSN</li></ol><h3 id="qBittorrent"><a href="#qBittorrent" class="headerlink" title="qBittorrent"></a>qBittorrent</h3><ol><li>套件中心搜索安装</li><li>默认用户名：admin，密码：adminadmin</li><li>qb设置<br><img src="/posts/7bc3db82/qb%E8%AE%BE%E7%BD%AE%E8%A1%8C%E4%B8%BA.jpg" alt="qb设置行为" title="qb设置行为"><br><img src="/posts/7bc3db82/qb%E8%AE%BE%E7%BD%AE%E4%B8%8B%E8%BD%BD.jpg" alt="qb设置下载" title="qb设置下载"><br><img src="/posts/7bc3db82/qb%E8%AE%BE%E7%BD%AE%E8%BF%9E%E6%8E%A5.jpg" alt="qb设置连接" title="qb设置连接"><br><img src="/posts/7bc3db82/qb%E8%AE%BE%E7%BD%AE%E9%80%9F%E5%BA%A6.jpg" alt="qb设置速度" title="qb设置速度"><br><img src="/posts/7bc3db82/qb%E8%AE%BE%E7%BD%AEBitTorrent.jpg" alt="qb设置BitTorrent" title="qb设置BitTorrent"><br><img src="/posts/7bc3db82/qb%E8%AE%BE%E7%BD%AEWebUI.jpg" alt="qb设置WebUI" title="qb设置WebUI"><br><img src="/posts/7bc3db82/qb%E8%AE%BE%E7%BD%AE%E9%AB%98%E7%BA%A7.jpg" alt="qb设置高级" title="qb设置高级"></li><li>启用Jackett插件，在搜索插件中安装Jackett的url，但不做任何修改会提示API错误</li></ol><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取root权限</span></span><br><span class="line">sudo -i</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">打开Jackett首页，复制右上角的API密钥</span></span><br><span class="line">vim /volume1/@appdata/qBittorrent/qBittorrent_conf/data/nova3/engines/jackett.json</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">替换api_key</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">替换url为NAS_IP:9117</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">保存退出</span></span><br></pre></td></tr></table></figure><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><h4 id="实用命令"><a href="#实用命令" class="headerlink" title="实用命令"></a>实用命令</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看现有存储池</span></span><br><span class="line">synospace --meta -e</span><br></pre></td></tr></table></figure><h4 id="查找占用带宽最大的进程，Docker注册表搜索下载镜像（janten-iftop-latest）"><a href="#查找占用带宽最大的进程，Docker注册表搜索下载镜像（janten-iftop-latest）" class="headerlink" title="查找占用带宽最大的进程，Docker注册表搜索下载镜像（janten&#x2F;iftop:latest）"></a>查找占用带宽最大的进程，Docker注册表搜索下载镜像（janten&#x2F;iftop:latest）</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取root权限</span></span><br><span class="line">sudo -i</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">这个镜像为我们提供了iftop命令</span></span><br><span class="line">docker run -it --rm --net host janten/iftop -P -i eth0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">使用netstat定位进程</span></span><br><span class="line">netstat -pantu | grep [port]</span><br></pre></td></tr></table></figure><h4 id="调用核显创建Docker容器"><a href="#调用核显创建Docker容器" class="headerlink" title="调用核显创建Docker容器"></a>调用核显创建Docker容器</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取root权限</span></span><br><span class="line">sudo -i</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">判断群晖是否有核显驱动，出现card0、renderD128才算成功</span></span><br><span class="line">ls -la /dev/dri</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">给所有用户给予文件可执行权限</span></span><br><span class="line">chmod a+x /dev/dri</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建容器</span></span><br><span class="line">docker create --name=emby --device /dev/dri:/dev/dri lovechen/embyserver:latest</span><br></pre></td></tr></table></figure><h4 id="利用nginx反向代理群晖内网服务使用QuickConnect访问，以Jellyfin为例"><a href="#利用nginx反向代理群晖内网服务使用QuickConnect访问，以Jellyfin为例" class="headerlink" title="利用nginx反向代理群晖内网服务使用QuickConnect访问，以Jellyfin为例"></a>利用nginx反向代理群晖内网服务使用QuickConnect访问，以Jellyfin为例</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取root权限</span></span><br><span class="line">sudo -i</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">nginx配置目录</span></span><br><span class="line">cd /etc/nginx/conf.d</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">新建配置文件</span></span><br><span class="line">vim dsm.jellyfin.conf</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">填入以下内容保存</span></span><br><span class="line">location ^~ /jellyfin &#123;</span><br><span class="line">  proxy_pass http://127.0.0.1:8096$request_uri;</span><br><span class="line">  proxy_redirect off;</span><br><span class="line">  proxy_set_header Host $host;</span><br><span class="line">  proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">  proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">测试配置文件</span></span><br><span class="line">nginx -t</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">重载配置文件</span></span><br><span class="line">nginx -s reload</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Jellyfin设置基础url为/jellyfin，重启系统</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">小白玩家第一次玩群晖的记录。</summary>
    
    
    
    <category term="技术笔记" scheme="https://addcoder.com/categories/%E6%8A%80%E6%9C%AF%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="NAS" scheme="https://addcoder.com/tags/NAS/"/>
    
    <category term="群晖" scheme="https://addcoder.com/tags/%E7%BE%A4%E6%99%96/"/>
    
  </entry>
  
  <entry>
    <title>No125：Git仓库初始化</title>
    <link href="https://addcoder.com/posts/6bc6db42"/>
    <id>https://addcoder.com/posts/6bc6db42</id>
    <published>2024-03-09T16:00:00.000Z</published>
    <updated>2024-03-09T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<ul><li><p>创建远程仓库，获取远程仓库地址</p></li><li><p>进入已有仓库根目录，删除.git文件夹</p></li><li><p>初始化仓库</p></li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git init</span><br></pre></td></tr></table></figure><ul><li>添加文件</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git add .</span><br></pre></td></tr></table></figure><ul><li>提交文件</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git commit -m &quot;init commit&quot;</span><br></pre></td></tr></table></figure><ul><li>配置远端仓库</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git remote add github https://github.com/guoxianru/pages_blog.git</span><br></pre></td></tr></table></figure><ul><li>推送(强制)到远程仓库</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git push -f origin &quot;master&quot;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">Git新建仓库初始化，已有仓库初始化。</summary>
    
    
    
    <category term="技术笔记" scheme="https://addcoder.com/categories/%E6%8A%80%E6%9C%AF%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Git" scheme="https://addcoder.com/tags/Git/"/>
    
  </entry>
  
  <entry>
    <title>No124：抖音、douyin、signature、ac_signature、X-Bogus、a_bogus</title>
    <link href="https://addcoder.com/posts/35a10144"/>
    <id>https://addcoder.com/posts/35a10144</id>
    <published>2024-02-19T16:00:00.000Z</published>
    <updated>2024-02-19T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<ul><li>目标URL</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">aHR0cHM6Ly92ZXJpZnkuc25zc2RrLmNvbS9jYXB0Y2hhL3ZlcmlmeQ==</span><br><span class="line">aHR0cHM6Ly93d3cuZG91eWluLmNvbS9hd2VtZS92MS93ZWIvdXNlci9wcm9maWxlL290aGVyLw==</span><br></pre></td></tr></table></figure><ul><li>目标参数</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">signature、ac_signature、X-Bogus、a_bogus、captchaBody</span><br></pre></td></tr></table></figure><ul><li>逆向过程</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">略</span><br></pre></td></tr></table></figure><ul><li>结果验证</li></ul><p><img src="/posts/35a10144/%E7%BB%93%E6%9E%9C%E9%AA%8C%E8%AF%811.jpg" alt="结果验证1" title="结果验证1"><br><img src="/posts/35a10144/%E7%BB%93%E6%9E%9C%E9%AA%8C%E8%AF%812.jpg" alt="结果验证2" title="结果验证2"></p>]]></content>
    
    
    <summary type="html">抖音WEB相关逆向方案。</summary>
    
    
    
    <category term="技术笔记" scheme="https://addcoder.com/categories/%E6%8A%80%E6%9C%AF%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="爬虫" scheme="https://addcoder.com/tags/%E7%88%AC%E8%99%AB/"/>
    
    <category term="JS逆向" scheme="https://addcoder.com/tags/JS%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>No123：得物、dewu、newSign</title>
    <link href="https://addcoder.com/posts/630217ad"/>
    <id>https://addcoder.com/posts/630217ad</id>
    <published>2024-02-09T16:00:00.000Z</published>
    <updated>2024-02-09T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<ul><li>目标URL</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">aHR0cHM6Ly9hcHAuZGV3dS5jb20vYXBpL3YxL2FwcC9jb21tb2RpdHkvaWNlL2JvdXRpcXVlLXJlY29tbWVuZC9kZXRhaWw=</span><br></pre></td></tr></table></figure><ul><li>目标参数</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">newSign</span><br></pre></td></tr></table></figure><ul><li>逆向过程</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">略</span><br></pre></td></tr></table></figure><ul><li>结果验证</li></ul><p><img src="/posts/630217ad/%E7%BB%93%E6%9E%9C%E9%AA%8C%E8%AF%81.jpg" alt="结果验证" title="结果验证"></p>]]></content>
    
    
    <summary type="html">得物APP相关逆向方案。</summary>
    
    
    
    <category term="技术笔记" scheme="https://addcoder.com/categories/%E6%8A%80%E6%9C%AF%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="爬虫" scheme="https://addcoder.com/tags/%E7%88%AC%E8%99%AB/"/>
    
    <category term="Android逆向" scheme="https://addcoder.com/tags/Android%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>No122：哔哩哔哩、bilibili、w_rid、qv_id</title>
    <link href="https://addcoder.com/posts/5341eae6"/>
    <id>https://addcoder.com/posts/5341eae6</id>
    <published>2024-01-19T16:00:00.000Z</published>
    <updated>2024-01-19T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<ul><li>目标URL</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Imh0dHBzOi8vYXBpLmJpbGliaWxpLmNvbS94L3dlYi1pbnRlcmZhY2Uvd2JpL3NlYXJjaC90eXBlIg==</span><br></pre></td></tr></table></figure><ul><li>目标参数</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">w_rid、qv_id</span><br></pre></td></tr></table></figure><ul><li>逆向过程</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">略</span><br></pre></td></tr></table></figure><ul><li>结果验证</li></ul><p><img src="/posts/5341eae6/%E7%BB%93%E6%9E%9C%E9%AA%8C%E8%AF%81.jpg" alt="结果验证" title="结果验证"></p>]]></content>
    
    
    <summary type="html">哔哩哔哩WEB相关逆向方案。</summary>
    
    
    
    <category term="技术笔记" scheme="https://addcoder.com/categories/%E6%8A%80%E6%9C%AF%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="爬虫" scheme="https://addcoder.com/tags/%E7%88%AC%E8%99%AB/"/>
    
    <category term="JS逆向" scheme="https://addcoder.com/tags/JS%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>No121：宝宝树、babytree、secret、signature</title>
    <link href="https://addcoder.com/posts/762f934c"/>
    <id>https://addcoder.com/posts/762f934c</id>
    <published>2024-01-09T16:00:00.000Z</published>
    <updated>2024-01-09T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<ul><li>目标URL</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">aHR0cDovL2dvLmJhYnl0cmVlLmNvbS9nb19hc2svYXBpL3F1ZXN0aW9uL2RldGFpbA==</span><br></pre></td></tr></table></figure><ul><li>目标参数</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">secret、signature</span><br></pre></td></tr></table></figure><ul><li>逆向过程</li></ul><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">略</span><br></pre></td></tr></table></figure><ul><li>结果验证</li></ul><p><img src="/posts/762f934c/%E7%BB%93%E6%9E%9C%E9%AA%8C%E8%AF%81.jpg" alt="结果验证" title="结果验证"></p>]]></content>
    
    
    <summary type="html">宝宝树APP相关逆向方案。</summary>
    
    
    
    <category term="技术笔记" scheme="https://addcoder.com/categories/%E6%8A%80%E6%9C%AF%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="爬虫" scheme="https://addcoder.com/tags/%E7%88%AC%E8%99%AB/"/>
    
    <category term="Android逆向" scheme="https://addcoder.com/tags/Android%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>No120：部署sekiro并升级为HTTPS</title>
    <link href="https://addcoder.com/posts/fcd35d35"/>
    <id>https://addcoder.com/posts/fcd35d35</id>
    <published>2023-12-19T16:00:00.000Z</published>
    <updated>2023-12-19T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="一、版本选择及部署"><a href="#一、版本选择及部署" class="headerlink" title="一、版本选择及部署"></a>一、版本选择及部署</h3><p><a href="https://sekiro.iinti.cn/sekiro-doc/">sekiro官方文档</a></p><p>第一代sekiro从2019年开发，自2021年4月终止开发，由于早期代码有太多底层架构方面的问题。故2021年进行了彻底的重构，并且本次重构试一次完全不兼容的重构。</p><p>我们建议使用2020(含)以前的版本的同学，尽快升级到新版。同时sekiro也关闭了老版本的docker自动构建通道。</p><ul><li>Sekiro服务端（旧版），服务器开放端口：5600-5603</li></ul><p><a href="https://github.com/virjar/sekiro/tree/a9b115709fbae88889a123e07fc09624d57ebe43">旧版</a></p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安装docker</span></span><br><span class="line">docker run --restart=always -d -p 5600:5600 -p 5601:5601 -p 5602:5602 -p 5603:5603 --name sekiro-server registry.cn-beijing.aliyuncs.com/virjar/sekiro-server:latest</span><br></pre></td></tr></table></figure><ul><li>Sekiro服务端（新版），服务器开放端口：5620</li></ul><p><a href="https://github.com/virjar/sekiro">新版</a></p><p><a href="https://oss.virjar.com/sekiro/sekiro-demo">下载demo</a></p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">需要Java环境</span></span><br><span class="line">nohup sh /bin/sekiro.sh</span><br></pre></td></tr></table></figure><h3 id="二、升级HTTPS"><a href="#二、升级HTTPS" class="headerlink" title="二、升级HTTPS"></a>二、升级HTTPS</h3><p>由于本人Java知识匮乏，所以使用Flask+uWSGI构建服务端，服务器需要有Java环境。</p><h4 id="0-启动sekiro"><a href="#0-启动sekiro" class="headerlink" title="0.启动sekiro"></a>0.启动sekiro</h4><p>在项目根目录下创建文件：api_sekiro_run.sh</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">ps -ef | grep sekiro-service-demo | grep -v grep | awk &#x27;&#123;print $2&#125;&#x27; | xargs kill -9</span><br><span class="line"></span><br><span class="line">sleep 3</span><br><span class="line"></span><br><span class="line">nohup sh /srv/api_sekiro/bin/sekiro.sh &gt;&gt;/srv/api_sekiro/logs/nohup_sekiro_server.log 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure><p>启动sekiro</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd /srv/api_sekiro &amp;&amp; sh /srv/api_sekiro/api_sekiro_run.sh</span><br></pre></td></tr></table></figure><h4 id="1-flask"><a href="#1-flask" class="headerlink" title="1.flask"></a>1.flask</h4><p>在项目根目录下创建文件：manage.py</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template</span><br><span class="line"><span class="keyword">from</span> flask_script <span class="keyword">import</span> Manager, Server</span><br><span class="line"></span><br><span class="line">logging.basicConfig(level=logging.INFO)</span><br><span class="line">app = Flask(__name__, template_folder=<span class="string">&quot;templates&quot;</span>)</span><br><span class="line">manager = Manager(app)</span><br><span class="line">manager.add_command(<span class="string">&quot;runserver&quot;</span>, Server(<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">11002</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">start_sekiro</span>():</span><br><span class="line">    os.popen(<span class="string">&quot;cd /srv/api_sekiro &amp;&amp; sh /srv/api_sekiro/api_sekiro_run.sh&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">stop_sekiro</span>():</span><br><span class="line">    os.popen(</span><br><span class="line">            <span class="string">&quot;ps -ef | grep sekiro-service-demo | grep -v grep | awk &#x27;&#123;print $2&#125;&#x27; | xargs kill -9&quot;</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>], strict_slashes=<span class="literal">False</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/start&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>], strict_slashes=<span class="literal">False</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">start</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        start_sekiro()</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;code&quot;</span>: <span class="string">&quot;1&quot;</span>, <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;sekiro服务启动成功&quot;</span>&#125;</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;code&quot;</span>: <span class="string">&quot;0&quot;</span>, <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;sekiro服务启动失败&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/stop&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>], strict_slashes=<span class="literal">False</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">stop</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        stop_sekiro()</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;code&quot;</span>: <span class="string">&quot;1&quot;</span>, <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;sekiro服务关闭成功&quot;</span>&#125;</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;code&quot;</span>: <span class="string">&quot;0&quot;</span>, <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;sekiro服务关闭失败&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    manager.run()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>在创建证书之前，在项目根目录下创建文件夹：&#x2F;templates，在该文件夹下创建文件：index.html</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Sekiro服务<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;/static/sekiro_web_client.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;icon&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/static/favicon.ico&quot;</span> <span class="attr">type</span>=<span class="string">&quot;image/x-icon&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;shortcut icon&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/static/favicon.ico&quot;</span> <span class="attr">type</span>=<span class="string">&quot;image/x-icon&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>接口说明<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">        1. /start</span><br><span class="line">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">        启动sekiro服务</span><br><span class="line">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">        2. /stop</span><br><span class="line">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">        关闭sekiro服务</span><br><span class="line">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">        3. /business-demo/groupList</span><br><span class="line">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">        sekiro服务的连接列表</span><br><span class="line">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">        4. wss://sekiro.xxx.com/business-demo/register?group=test&amp;clientId=xxx</span><br><span class="line">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">        客户端连接服务端</span><br><span class="line">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">        5. https://sekiro.xxx.com/business-demo/invoke?group=test&amp;action=xxx&amp;xxx=xxx</span><br><span class="line">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">        服务端调用客户端</span><br><span class="line">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>Sekiro服务部署<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">        1. Sekiro服务端（新版），服务器开放端口：5620</span><br><span class="line">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">        https://sekiro.virjar.com/sekiro-doc/02_server_deploy/1.DemoServer.html.com/virjar/sekiro-server:latest</span><br><span class="line">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">        2. Sekiro服务端（旧版），服务器开放端口：5600-5603</span><br><span class="line">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">        docker run --restart=always -d -p 5600:5600 -p 5601:5601 -p 5602:5602 -p 5603:5603 --name sekiro-server registry.cn-beijing.aliyuncs.com/virjar/sekiro-server:latest</span><br><span class="line">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="2-uwsgi"><a href="#2-uwsgi" class="headerlink" title="2.uwsgi"></a>2.uwsgi</h4><ul><li>配置uwsgi.ini文件</li></ul><p>在项目文件夹与manage.py同级的目录下创建uwsgi.ini，文件内容如下（注意路径）：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[uwsgi]</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">uwsgi监听的socket，一会儿配置Nginx会用到</span></span><br><span class="line">socket = 127.0.0.1:11002</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">在app加载前切换到该目录，设置为Flask项目根目录</span></span><br><span class="line">chdir = /srv/api_sekiro</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">加载指定的python WSGI模块，设置为Flask项目的manage文件</span></span><br><span class="line">wsgi-file = ./manage.py</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">指定app对象实例</span></span><br><span class="line">callable = app</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">启动一个master进程来管理其他进程</span></span><br><span class="line">master = true</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">工作的进程数</span></span><br><span class="line">processes = 2</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">每个进程下的线程数量</span></span><br><span class="line">threads = 4</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">当服务器退出的时候自动删除unix socket文件和pid文件</span></span><br><span class="line">vacuum = true</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">使进程在后台运行，并将日志打到指定的日志文件或者udp服务器</span></span><br><span class="line">daemonize = /srv/api_sekiro/uwsgi.log</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>加载配置文件</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">uwsgi --ini uwsgi_api_sekiro.ini</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">出现getting INI configuration from uwsgi.ini（成功）</span></span><br></pre></td></tr></table></figure><ul><li><p>项目有更新的时候，需要先关闭uwsgi然后重启即可</p></li><li><p>基本命令</p></li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">启动uwsgi服务器</span></span><br><span class="line">uwsgi --ini uwsgi_api_sekiro.ini</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看uwsgi是否运行</span></span><br><span class="line">ps -aux | grep uwsgi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看端口号占用</span></span><br><span class="line">netstat -anp | grep 5050</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">结束uwsgi进程</span></span><br><span class="line">pgrep uwsgi | xargs kill -s 9</span><br></pre></td></tr></table></figure><h4 id="3-Let’s-Encrypt免费证书"><a href="#3-Let’s-Encrypt免费证书" class="headerlink" title="3.Let’s Encrypt免费证书"></a>3.Let’s Encrypt免费证书</h4><p>在创建证书之前，在项目根目录下创建文件夹：&#x2F;.well-know，在该文件夹下创建文件：acme-challenge</p><h4 id="4-配置Nginx"><a href="#4-配置Nginx" class="headerlink" title="4.配置Nginx"></a>4.配置Nginx</h4><p>编辑配置文件</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo vim /etc/nginx/conf.d/sekiro.conf</span><br></pre></td></tr></table></figure><p>示例</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">sekiro框架</span></span><br><span class="line">upstream sekiro_business_netty &#123;</span><br><span class="line">  server 127.0.0.1:5620;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">网站配置</span></span><br><span class="line">server &#123;</span><br><span class="line">    # 设置监听端口</span><br><span class="line">    listen 80;</span><br><span class="line">    # 设置对外访问入口,可以是域名可以是公网IP</span><br><span class="line">    server_name sekiro.xxx.com;</span><br><span class="line">    # 设置虚拟主机的基本信息</span><br><span class="line">    location / &#123;</span><br><span class="line">        include uwsgi_params;</span><br><span class="line">        uwsgi_pass 127.0.0.1:11002;</span><br><span class="line">        uwsgi_read_timeout 60;</span><br><span class="line">    &#125;</span><br><span class="line">    # 静态文件设置</span><br><span class="line">    location /static &#123;</span><br><span class="line">        expires 30d;</span><br><span class="line">        alias /srv/api_sekiro/static/;</span><br><span class="line">    &#125;</span><br><span class="line">    # 创建Let’s Encrypt免费SSL证书临时文件</span><br><span class="line">    location /.well-known/acme-challenge &#123;</span><br><span class="line">        alias /srv/api_sekiro/.well-known/acme-challenge;</span><br><span class="line">    &#125;</span><br><span class="line">    # sekiro框架</span><br><span class="line">    location /business-demo &#123;</span><br><span class="line">        proxy_http_version 1.1;</span><br><span class="line">        proxy_read_timeout 500;</span><br><span class="line">        proxy_connect_timeout 300;</span><br><span class="line">        proxy_redirect off;</span><br><span class="line">        proxy_set_header Upgrade            $http_upgrade;</span><br><span class="line">        proxy_set_header Host               $http_host;</span><br><span class="line">        proxy_set_header X-Real-IP          $remote_addr;</span><br><span class="line">        proxy_set_header X-Forwarded-For    $proxy_add_x_forwarded_for;</span><br><span class="line">        proxy_set_header X-Forwarded-Proto  $scheme;</span><br><span class="line">        proxy_pass http://sekiro_business_netty;</span><br><span class="line">    &#125;</span><br><span class="line">    # 允许网段</span><br><span class="line">    allow all;</span><br><span class="line">    # 设置访问的语言编码</span><br><span class="line">    charset UTF-8;</span><br><span class="line">    # nginx的超时参数设置为60秒</span><br><span class="line">    send_timeout 60;</span><br><span class="line">    # 实IP在X-Forwarded-For请求头中</span><br><span class="line">    real_ip_header X-Real-IP;</span><br><span class="line">    # X-Forwarded-For请求头中的最后一个IP当成真实IP</span><br><span class="line">    real_ip_recursive off;</span><br><span class="line">    # 设置fastcgi缓冲区为8块128k大小的空间</span><br><span class="line">    fastcgi_buffers 8 128k;</span><br><span class="line">    # 上传文件大小限制,默认1m</span><br><span class="line">    client_max_body_size 0;</span><br><span class="line">    # 访问日志记录</span><br><span class="line">    access_log /var/log/nginx/sekiro_access.log;</span><br><span class="line">    # 错误日志记录</span><br><span class="line">    error_log /var/log/nginx/sekiro_error.log;</span><br><span class="line">    # 开启gzip</span><br><span class="line">    gzip on;</span><br><span class="line">    # 是否在http header中添加Vary:Accept-Encoding</span><br><span class="line">    gzip_vary on;</span><br><span class="line">    # 设置压缩所需要的缓冲区大小</span><br><span class="line">    gzip_buffers 32 4K;</span><br><span class="line">    # gzip 压缩级别,1-9,数字越大压缩的越好,也越占用CPU时间</span><br><span class="line">    gzip_comp_level 5;</span><br><span class="line">    # 启用gzip压缩的最小文件,小于设置值的文件将不会压缩</span><br><span class="line">    gzip_min_length 100;</span><br><span class="line">    # 配置禁用gzip条件,支持正则</span><br><span class="line">    gzip_disable &quot;MSIE [1-6]\.&quot;;</span><br><span class="line">    # 进行压缩的文件类型</span><br><span class="line">    gzip_types application/javascript text/css text/xml;</span><br><span class="line">    # HTTP严格传输安全的max-age需要大于15768000秒</span><br><span class="line">    add_header Strict-Transport-Security &quot;max-age=31536000&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="5-重启nginx，以便生效"><a href="#5-重启nginx，以便生效" class="headerlink" title="5.重启nginx，以便生效"></a>5.重启nginx，以便生效</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">centos7</span></span><br><span class="line">systemctl restart nginx</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Ubuntu16.04</span></span><br><span class="line">/etc/init.d/nginx restart</span><br></pre></td></tr></table></figure><h4 id="6-安装certbot"><a href="#6-安装certbot" class="headerlink" title="6.安装certbot"></a>6.安装certbot</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">centos7</span></span><br><span class="line">yum install -y certbot</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Ubuntu16.04</span></span><br><span class="line">sudo add-apt-repository ppa:certbot/certbot</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install certbot</span><br></pre></td></tr></table></figure><h4 id="7-签发SSL证书"><a href="#7-签发SSL证书" class="headerlink" title="7.签发SSL证书"></a>7.签发SSL证书</h4><p>两种生成证书的方式</p><ul><li>andalone</li></ul><p>certbot会启动自带的nginx（如果服务器上已经有nginx或apache运行，需要停止已有的nginx或apache）生成证书。</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">certbot certonly --standalone -d sekiro.xxx.com</span><br></pre></td></tr></table></figure><ul><li>webroot(推荐)</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">certbot certonly --webroot -w /srv/api_sekiro -d sekiro.xxx.com</span><br></pre></td></tr></table></figure><p>-w：指定项目绝对路径。</p><p>-d：指定生成证书域名，不可以直接写IP。</p><p>这条命令的输出类似于这样(Congratulations)为成功。</p><p>证书位置：&#x2F;etc&#x2F;letsencrypt&#x2F;live&#x2F;sekiro.xxx.com&#x2F;fullchain.pem</p><p>私钥位置：&#x2F;etc&#x2F;letsencrypt&#x2F;live&#x2F;sekiro.xxx.com&#x2F;privkey.pem</p><h4 id="8-生成前向安全性密钥"><a href="#8-生成前向安全性密钥" class="headerlink" title="8.生成前向安全性密钥"></a>8.生成前向安全性密钥</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd /etc/letsencrypt/live</span><br><span class="line">openssl dhparam 2048 -out dhparam.pem</span><br></pre></td></tr></table></figure><h4 id="9-将https配置进Nginx"><a href="#9-将https配置进Nginx" class="headerlink" title="9.将https配置进Nginx"></a>9.将https配置进Nginx</h4><ul><li>配置</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">sekiro框架</span></span><br><span class="line">upstream sekiro_business_netty &#123;</span><br><span class="line">  server 127.0.0.1:5620;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">网站配置</span></span><br><span class="line">server &#123;</span><br><span class="line">    # 设置监听端口</span><br><span class="line">    listen 80;</span><br><span class="line">    # 设置监听端口,开启https,默认端口</span><br><span class="line">    listen 443 ssl;</span><br><span class="line">    # 设置对外访问入口,可以是域名可以是公网IP</span><br><span class="line">    server_name sekiro.xxx.com;</span><br><span class="line">    # HTTP请求301永久跳转到HTTPS</span><br><span class="line">    if ($server_port = 80) &#123;</span><br><span class="line">        return 301 https://$server_name$request_uri;</span><br><span class="line">    &#125;</span><br><span class="line">    # 设置虚拟主机的基本信息</span><br><span class="line">    location / &#123;</span><br><span class="line">        include uwsgi_params;</span><br><span class="line">        uwsgi_pass 127.0.0.1:11002;</span><br><span class="line">        uwsgi_read_timeout 60;</span><br><span class="line">    &#125;</span><br><span class="line">    # 静态文件设置</span><br><span class="line">    location /static &#123;</span><br><span class="line">        expires 30d;</span><br><span class="line">        alias /srv/api_sekiro/static/;</span><br><span class="line">    &#125;</span><br><span class="line">    # 创建Let’s Encrypt免费SSL证书临时文件</span><br><span class="line">    location /.well-known/acme-challenge &#123;</span><br><span class="line">        alias /srv/api_sekiro/.well-known/acme-challenge;</span><br><span class="line">    &#125;</span><br><span class="line">    # sekiro框架</span><br><span class="line">    location /business-demo &#123;</span><br><span class="line">        proxy_http_version 1.1;</span><br><span class="line">        proxy_read_timeout 500;</span><br><span class="line">        proxy_connect_timeout 300;</span><br><span class="line">        proxy_redirect off;</span><br><span class="line">        proxy_set_header Upgrade            $http_upgrade;</span><br><span class="line">        proxy_set_header Host               $http_host;</span><br><span class="line">        proxy_set_header X-Real-IP          $remote_addr;</span><br><span class="line">        proxy_set_header X-Forwarded-For    $proxy_add_x_forwarded_for;</span><br><span class="line">        proxy_set_header X-Forwarded-Proto  $scheme;</span><br><span class="line">        proxy_pass http://sekiro_business_netty;</span><br><span class="line">    &#125;</span><br><span class="line">    # session会话的缓存类型和大小</span><br><span class="line">    ssl_session_cache shared:SSL:10m;</span><br><span class="line">    # ession会话的超时时间</span><br><span class="line">    ssl_session_timeout 10m;</span><br><span class="line">    # 依赖SSLv3和TLSv1协议的服务器密码将优先于客户端密码</span><br><span class="line">    ssl_prefer_server_ciphers on;</span><br><span class="line">    # 证书位置</span><br><span class="line">    ssl_certificate /etc/letsencrypt/live/sekiro.xxx.com/fullchain.pem;</span><br><span class="line">    # 私钥位置</span><br><span class="line">    ssl_certificate_key /etc/letsencrypt/live/sekiro.xxx.com/privkey.pem;</span><br><span class="line">    # 前向安全性,DH-Key交换密钥文件位置</span><br><span class="line">    ssl_dhparam /etc/letsencrypt/live/dhparam.pem;</span><br><span class="line">    # PCI DSS支付卡行业安全标准,禁用不安全的SSLv1 2 3,只使用TLS,PCI安全标准委员会规定开启TLS1.0将导致PCI DSS不合规</span><br><span class="line">    ssl_protocols TLSv1.1 TLSv1.2;</span><br><span class="line">    # 需要配置符合PFS规范的加密套件</span><br><span class="line">    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4:!DH:!DHE;</span><br><span class="line">    # 允许网段</span><br><span class="line">    allow all;</span><br><span class="line">    # 设置访问的语言编码</span><br><span class="line">    charset UTF-8;</span><br><span class="line">    # nginx的超时参数设置为60秒</span><br><span class="line">    send_timeout 60;</span><br><span class="line">    # 实IP在X-Forwarded-For请求头中</span><br><span class="line">    real_ip_header X-Real-IP;</span><br><span class="line">    # X-Forwarded-For请求头中的最后一个IP当成真实IP</span><br><span class="line">    real_ip_recursive off;</span><br><span class="line">    # 设置fastcgi缓冲区为8块128k大小的空间</span><br><span class="line">    fastcgi_buffers 8 128k;</span><br><span class="line">    # 上传文件大小限制,默认1m</span><br><span class="line">    client_max_body_size 0;</span><br><span class="line">    # 访问日志记录</span><br><span class="line">    access_log /var/log/nginx/sekiro_access.log;</span><br><span class="line">    # 错误日志记录</span><br><span class="line">    error_log /var/log/nginx/sekiro_error.log;</span><br><span class="line">    # 开启gzip</span><br><span class="line">    gzip on;</span><br><span class="line">    # 是否在http header中添加Vary:Accept-Encoding</span><br><span class="line">    gzip_vary on;</span><br><span class="line">    # 设置压缩所需要的缓冲区大小</span><br><span class="line">    gzip_buffers 32 4K;</span><br><span class="line">    # gzip 压缩级别,1-9,数字越大压缩的越好,也越占用CPU时间</span><br><span class="line">    gzip_comp_level 5;</span><br><span class="line">    # 启用gzip压缩的最小文件,小于设置值的文件将不会压缩</span><br><span class="line">    gzip_min_length 100;</span><br><span class="line">    # 配置禁用gzip条件,支持正则</span><br><span class="line">    gzip_disable &quot;MSIE [1-6]\.&quot;;</span><br><span class="line">    # 进行压缩的文件类型</span><br><span class="line">    gzip_types application/javascript text/css text/xml;</span><br><span class="line">    # HTTP严格传输安全的max-age需要大于15768000秒</span><br><span class="line">    add_header Strict-Transport-Security &quot;max-age=31536000&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>重启nginx，以便生效</li></ul><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">切换到项目目录下运行</span></span><br><span class="line">uwsgi --ini uwsgi_api_sekiro.ini</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">重启nginx服务</span></span><br><span class="line">systemctl restart nginx</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">sekiro是一个基于长链接和代码注入的API暴露框架，可以用在数据抓取等场景，本文主要介绍如何部署该框架和升级为https的方法。</summary>
    
    
    
    <category term="技术笔记" scheme="https://addcoder.com/categories/%E6%8A%80%E6%9C%AF%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="爬虫" scheme="https://addcoder.com/tags/%E7%88%AC%E8%99%AB/"/>
    
    <category term="Android逆向" scheme="https://addcoder.com/tags/Android%E9%80%86%E5%90%91/"/>
    
    <category term="HTTPS" scheme="https://addcoder.com/tags/HTTPS/"/>
    
    <category term="JS逆向" scheme="https://addcoder.com/tags/JS%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>No119：Linux常用解压缩命令</title>
    <link href="https://addcoder.com/posts/46ab0914"/>
    <id>https://addcoder.com/posts/46ab0914</id>
    <published>2023-12-09T16:00:00.000Z</published>
    <updated>2023-12-09T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="一、-gzip-gunzip"><a href="#一、-gzip-gunzip" class="headerlink" title="一、 gzip&#x2F;gunzip"></a>一、 gzip&#x2F;gunzip</h3><h4 id="1-特点"><a href="#1-特点" class="headerlink" title="1.特点"></a>1.特点</h4><ol><li>只能压缩文件不能压缩目录</li><li>不保留原来的文件</li><li>同时压缩多个文件会产生多个压缩包</li></ol><h4 id="2-操作"><a href="#2-操作" class="headerlink" title="2.操作"></a>2.操作</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">压缩</span></span><br><span class="line">gzip test.txt</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">解压</span></span><br><span class="line">gunzip test.txt.gz</span><br></pre></td></tr></table></figure><h3 id="二、zip-unzip"><a href="#二、zip-unzip" class="headerlink" title="二、zip&#x2F;unzip"></a>二、zip&#x2F;unzip</h3><h4 id="1-特点-1"><a href="#1-特点-1" class="headerlink" title="1.特点"></a>1.特点</h4><ol><li>压缩命令在Windows&#x2F;Linux都通用</li><li>可以压缩目录且保留源文件</li></ol><h4 id="2-操作-1"><a href="#2-操作-1" class="headerlink" title="2.操作"></a>2.操作</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">压缩</span></span><br><span class="line">zip test.zip test1.txt test2.txt</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">解压</span></span><br><span class="line">unzip test.zip</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">解压到指定目录</span></span><br><span class="line">unzip test.zip -d /home</span><br></pre></td></tr></table></figure><h3 id="三、tar"><a href="#三、tar" class="headerlink" title="三、tar"></a>三、tar</h3><h4 id="1-选项"><a href="#1-选项" class="headerlink" title="1.选项"></a>1.选项</h4><table><thead><tr><th>选项</th><th>功能</th></tr></thead><tbody><tr><td>-c</td><td>产生.tar打包文件</td></tr><tr><td>-v</td><td>显示详细信息</td></tr><tr><td>-f</td><td>指定压缩后的文件名</td></tr><tr><td>-z</td><td>打包同时压缩</td></tr><tr><td>-x</td><td>解包.tar文件</td></tr><tr><td>-C</td><td>解压到指定目录</td></tr></tbody></table><h4 id="2-操作-2"><a href="#2-操作-2" class="headerlink" title="2.操作"></a>2.操作</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">压缩文件</span></span><br><span class="line">tar -zcvf test.tar.gz test1.txt test2.txt</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">压缩目录</span></span><br><span class="line">tar -zcvf test.tar.gz test/</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">解压</span></span><br><span class="line">tar -zxvf test.tar.gz</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">解压到指定目录</span></span><br><span class="line">tar -zxvf test.tar.gz -C /home</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">常用的Linux下各种格式的解压缩方法。</summary>
    
    
    
    <category term="技术笔记" scheme="https://addcoder.com/categories/%E6%8A%80%E6%9C%AF%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Linux" scheme="https://addcoder.com/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>No118：MySQL清空表的各种方法</title>
    <link href="https://addcoder.com/posts/13e04199"/>
    <id>https://addcoder.com/posts/13e04199</id>
    <published>2023-11-19T16:00:00.000Z</published>
    <updated>2023-11-19T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="1、MySQL清空表数据命令：truncate"><a href="#1、MySQL清空表数据命令：truncate" class="headerlink" title="1、MySQL清空表数据命令：truncate"></a>1、MySQL清空表数据命令：truncate</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">truncate table 表名</span><br></pre></td></tr></table></figure><p>注意：</p><ul><li>不能与where一起使用。</li><li>truncate删除数据后是不可以rollback的。</li><li>truncate删除数据后会重置Identity（标识列、自增字段），相当于自增列会被置为初始值，又重新从1开始记录，而不是接着原来的ID数。</li><li>truncate删除数据后不写服务器log，整体删除速度快。</li><li>truncate删除数据后不激活trigger(触发器)。</li></ul><h3 id="2、MySQL删除表命令：drop"><a href="#2、MySQL删除表命令：drop" class="headerlink" title="2、MySQL删除表命令：drop"></a>2、MySQL删除表命令：drop</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">drop table 表名;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">或者是</span></span><br><span class="line">drop table if exists 表名;</span><br></pre></td></tr></table></figure><p>注意：</p><ul><li>truncate只会清除表数据，drop不光清除表数据还要删除表结构。</li></ul><h3 id="3、MySQL清空数据表指定内容的语法：delete"><a href="#3、MySQL清空数据表指定内容的语法：delete" class="headerlink" title="3、MySQL清空数据表指定内容的语法：delete"></a>3、MySQL清空数据表指定内容的语法：delete</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">delete from 表名 where id=&#x27;1&#x27;;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">或者是</span></span><br><span class="line">delete from 表名;</span><br></pre></td></tr></table></figure><p>注意：</p><ul><li>delete含义：你要删除哪张表的数据?你要删掉哪些行?</li><li>delete可以删除一行，也可以删除多行；</li><li>如果不加where条件，则是删除表所有的数据，这是很危险的！不建议这样做！</li></ul><h3 id="4、总结"><a href="#4、总结" class="headerlink" title="4、总结"></a>4、总结</h3><ul><li>当你不再需要该表时，用drop;</li><li>当你仍要保留该表，但要删除所有数据表记录时，用truncate;</li><li>当你要删除部分记录或者有可能会后悔的话，用delete。</li></ul>]]></content>
    
    
    <summary type="html">MySQL提供了多种方法来清空表，下面将介绍常用的三种方法。</summary>
    
    
    
    <category term="技术笔记" scheme="https://addcoder.com/categories/%E6%8A%80%E6%9C%AF%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="MySQL" scheme="https://addcoder.com/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>No117：MySQL自增ID归1</title>
    <link href="https://addcoder.com/posts/b470718c"/>
    <id>https://addcoder.com/posts/b470718c</id>
    <published>2023-11-09T16:00:00.000Z</published>
    <updated>2023-11-09T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>自增ID不满足需求时可以改变。</p></blockquote><h3 id="1、清空所有数据，自增字段恢复从1开始计数"><a href="#1、清空所有数据，自增字段恢复从1开始计数" class="headerlink" title="1、清空所有数据，自增字段恢复从1开始计数"></a>1、清空所有数据，自增字段恢复从1开始计数</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">truncate table 表名;</span><br></pre></td></tr></table></figure><h3 id="2、自增字段恢复从1开始计数"><a href="#2、自增字段恢复从1开始计数" class="headerlink" title="2、自增字段恢复从1开始计数"></a>2、自增字段恢复从1开始计数</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">alter table 表名 AUTO_INCREMENT=1;</span><br></pre></td></tr></table></figure><h3 id="3、清空具有外键约束的表时报ERROR-1701-42000-的解决方法"><a href="#3、清空具有外键约束的表时报ERROR-1701-42000-的解决方法" class="headerlink" title="3、清空具有外键约束的表时报ERROR 1701(42000)的解决方法"></a>3、清空具有外键约束的表时报ERROR 1701(42000)的解决方法</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">关闭外键约束</span></span><br><span class="line">SET foreign_key_checks=0;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">开启外键约束</span></span><br><span class="line">SET foreign_key_checks=1;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">自增ID不满足需求时可以改变。</summary>
    
    
    
    <category term="技术笔记" scheme="https://addcoder.com/categories/%E6%8A%80%E6%9C%AF%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="MySQL" scheme="https://addcoder.com/tags/MySQL/"/>
    
  </entry>
  
</feed>
